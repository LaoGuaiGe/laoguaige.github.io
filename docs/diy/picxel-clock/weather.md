---
title: è·å–å¤©æ°”æƒ…å†µ
keywords: keyword1, keyword2
desc: description for this article
show_source: false
update:
  - date: 2024-12-05
    author: è€æ€ªé¸½
    version: 1.0.1
    content: æ›´æ–°äº†åŸºæœ¬æ–‡æ¡£
---

## ç¡¬ä»¶å‡†å¤‡
---
ä½ åªéœ€è¦æœ‰ä¸€ä¸ªESP32S3å¼€å‘æ¿ã€‚æˆ‘ç›®å‰ä½¿ç”¨çš„æ˜¯ï¼šç«‹åˆ›å¼€å‘æ¿çš„ç«‹åˆ›Â·ESP32S3R8N8å¼€å‘æ¿ã€‚

> **è´­ä¹°åœ°å€ï¼š**[ç«‹åˆ›Â·ESP32S3R8N8 å¼€å‘æ¿](https://item.szlcsc.com/22034693.html?fromZone=s_s__%2522%25E7%25AB%258B%25E5%2588%259B%25E5%25BC%2580%25E5%258F%2591%25E6%259D%25BF%2522)


## å’Œé£å¤©æ°”API
---
### å’Œé£å¤©æ°”ä»‹ç»

> [å’Œâ»›å¤©æ°”](https://www.qweather.com/)æ˜¯ä¸­å›½é¢†å…ˆçš„æ°”è±¡ç§‘æŠ€æœåŠ¡å•†ã€å›½å®¶é«˜æ–°æŠ€æœ¯ ä¼ä¸šï¼Œè‡´åŠ›äºè¿ç”¨å…ˆè¿›æ°”è±¡æ¨¡å‹ç»“åˆå¤§æ•°æ®ã€äººå·¥æ™ºèƒ½ æŠ€æœ¯å‘å±•æ™ºæ…§å‹æ°”è±¡æœåŠ¡ã€‚
ä»–ä»¬çš„ä¸šåŠ¡åŒ…æ‹¬æ°”è±¡æ•°æ®åˆ†å‘ã€åœ°ç†ä¿¡æ¯ã€æ°”è±¡å¯è§† åŒ–ã€ä¸ªäººæ°”è±¡æœåŠ¡ç­‰ï¼Œåœ¨å…¨çƒ10ä¸ªå›½å®¶å»ºæœ‰æ•°æ®ä¸­å¿ƒï¼Œ ä¸º300ä½™å®¶ä¸­å›½åŠå…¨çƒä¼ä¸šã€50ä¸‡å¼€å‘è€…æä¾›ä¼˜è´¨çš„æ•° æ®æœåŠ¡ã€‚

**å¦å¤–çš„è¯**

> å’Œé£å¤©æ°”æ”¯æŒç”¨æˆ·å…è´¹ä½¿ç”¨è®¢é˜…ï¼Œåªæ˜¯ä¸€ä¸ªç”¨æˆ·åªèƒ½åˆ›å»ºä¸€ä¸ªé¡¹ç›®APIï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬æ¥è¯´å·²ç»è¶³å¤Ÿäº†ï¼Œæ„Ÿè°¢å’Œé£å¤©æ°”ï¼


### åˆ›å»ºè‡ªå·±çš„å¤©æ°”API
è¯·å‰å¾€ [å’Œé£å¤©æ°”API](https://dev.qweather.com/) å®˜ç½‘ï¼Œæ³¨å†Œè´¦å·å¹¶è¿›å…¥æ§åˆ¶å°ã€‚

![å›¾ 0](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-51-48.png)  


å…³äºå’Œé£å¤©æ°”çš„APIä»‹ç»å’Œå¼€å‘æ–‡æ¡£ï¼Œå‚è€ƒæ§åˆ¶å°å¤„çš„ä»‹ç»ï¼š

![å›¾ 2](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-52-04.png)  



å¼€å§‹åˆ›å»ºå±äºæˆ‘ä»¬çš„API ! 

![å›¾ 1](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-51-58.png)  


å’Œé£å¤©æ°”é¡¹ç›®åˆ›å»ºå‚æ•°å¡«å†™ï¼š

![å›¾ 3](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-52-18.png)  


å®Œæˆåˆ›å»ºï¼

![å›¾ 4](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-52-23.png)  

### APIä»‹ç»

å’Œé£å¤©æ°”çš„ [APIä»‹ç»ç½‘é¡µ](https://dev.qweather.com/docs/api/) å¦‚ä¸‹ï¼š

![å›¾ 5](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-52-33.png)  


æœ¬æ–‡å°†ç”¨çš„APIæ˜¯``åŸå¸‚å¤©æ°” -> æ¯æ—¥å¤©æ°”é¢„æŠ¥ -> 3å¤©é¢„æŠ¥API`` ã€‚[ã€APIçš„è¯¦ç»†ä»‹ç»é¡µç‚¹æˆ‘ã€‘](https://dev.qweather.com/docs/api/weather/weather-daily-forecast/)

![å›¾ 6](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-52-38.png)  

>**éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ˜¯å…è´¹è®¢é˜…ï¼Œè¦å°†API Hostæ›´æ”¹ä¸º ``devapi.qweather.com``ã€‚**

è¿™é‡Œä»¥è·å–æ·±åœ³``3å¤©çš„å¤©æ°”é¢„æŠ¥ä¸ºä¾‹``ï¼Œå…³é”®çš„APIå‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š

```html
https://devapi.qweather.com/v7/weather/3d?location=101280601&key=YOUR_KEY
```

>è¯·æ±‚å‚æ•°åŒ…æ‹¬å¿…é€‰å’Œå¯é€‰å‚æ•°ï¼Œå‚æ•°ä¹‹é—´ä½¿ç”¨&è¿›è¡Œåˆ†éš”ã€‚è¿™é‡Œåªç»™å¤§å®¶ä»‹ç»å¿…å¡«é¡¹ã€‚
**1. key(å¿…é€‰)** ï¼š ç”¨æˆ·è®¤è¯keyï¼Œè¯·å‚è€ƒ[å¦‚ä½•è·å–ä½ çš„KEY](https://dev.qweather.com/docs/configuration/project-and-key/)ã€‚
**2. location(å¿…é€‰)** ï¼š éœ€è¦æŸ¥è¯¢åœ°åŒºçš„[LocationID](https://dev.qweather.com/docs/resource/glossary/#locationid)æˆ–ä»¥è‹±æ–‡é€—å·åˆ†éš”çš„ç»åº¦,çº¬åº¦åæ ‡ï¼ˆåè¿›åˆ¶ï¼Œæœ€å¤šæ”¯æŒå°æ•°ç‚¹åä¸¤ä½ï¼‰ï¼ŒLocationIDå¯é€šè¿‡GeoAPIè·å–ã€‚ä¾‹å¦‚ location=101010100 æˆ– location=116.41,39.92

å…³äºè¿™ä¸ªLocationIDéœ€è¦å„ä½è‡ªè¡Œæ ¹æ®å’Œé£å¤©æ°”å®˜æ–¹çš„githubåœ°å€æŸ¥è¯¢ï¼Œè¿™é‡Œæˆ‘æ‰¾åˆ°æ·±åœ³çš„LocationIDä¸ºï¼š``101280601``

![å›¾ 7](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-52-56.png)  

### æ‰‹åŠ¨éªŒè¯APIæ˜¯å¦æ­£ç¡®

é¦–å…ˆå›åˆ°ä½ çš„å’Œé£å¤©æ°”ç®¡ç†å°ã€‚ä½ ä¼šçœ‹åˆ°ä½ æ–°å»ºçš„é¡¹ç›®ã€‚

![å›¾ 8](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-53-03.png)  

å¤åˆ¶ä½ çš„å¯†é’¥``KEY``ã€‚

![å›¾ 9](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-53-09.png)  


ç„¶åå°†ä½ çš„``KEY``å¡«å……åˆ°ä¸‹æ–¹APIçš„``YOUR_KEY``ä¸­

> ä¸‹æ–¹è¿™ä¸ªæ˜¯è·å–æ·±åœ³3å¤©çš„å¤©æ°”é¢„æŠ¥APIï¼Œåªå‰©KEYæ²¡æœ‰å¡«å†™

```html
https://devapi.qweather.com/v7/weather/3d?location=101280601&key=YOUR_KEY
```

ä¾‹å¦‚æˆ‘çš„KEYæ˜¯ `ABCasdsdgsdfgdsgdfgdf`ï¼Œåˆ™æˆ‘çš„APIæ˜¯

```heml
https://devapi.qweather.com/v7/weather/3d?location=101280601&key=ABCasdsdgsdfgdsgdfgdf
```

å¡«å†™ä½ çš„``KEY``åï¼Œç›´æ¥å¤åˆ¶è¯¥``API``ï¼Œå°†å®ƒä½œä¸ºç½‘å€è·³è½¬åˆ°å¯¹åº”é¡µé¢ï¼Œä½ å°±ä¼šçœ‹çš„è¿”å›çš„å¤©æ°”æ•°æ®ã€‚

![å›¾ 10](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-53-50.png)  


å…³äºAPIè¿”å›çš„æ•°æ®å…·ä½“çš„æ„æ€æ˜¯ä»€ä¹ˆï¼Œå‚è€ƒè¯¥[APIçš„ä»‹ç»é¡µ](https://dev.qweather.com/docs/api/weather/weather-daily-forecast/)ã€‚

![å›¾ 11](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-53-57.png)  


**æ ¹æ®è¿”å›çš„å‚æ•°è¯´æ˜ï¼Œè¿™é‡Œæˆ‘å…³æ³¨çš„æ˜¯4ä¸ªæ•°æ®ï¼š**

![å›¾ 12](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-54-03.png)  


å›¾æ ‡ä»£ç çš„è¯´æ˜ï¼šè¿”å›çš„æ•°æ®ä¸­å…³äºå¤©æ°”çš„è¯´æ˜åªæœ‰ç©ºè½è½çš„æ•°å­—ï¼Œè¿™äº›æ•°å­—åœ¨APIè¯´æ˜ä¸­ä»£è¡¨ç€å„ä¸ªå¤©æ°”æƒ…å†µã€‚[æ•°å­—å¯¹åº”çš„å¤©æ°”æƒ…å†µé“¾æ¥ã€‚](https://dev.qweather.com/docs/resource/icons/)

![å›¾ 13](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-54-11.png)  

åˆ°è¿™é‡Œæˆ‘ä»¬å°±å·²ç»æ˜¯å‡†å¤‡å¥½äº†ï¼Œæ¥ä¸‹æ¥å¯ä»¥ä¸Šå·¥ç¨‹ä»£ç äº†ã€‚è¯·å‡†å¤‡å¥½ä½ çš„``å®Œæ•´API``å’Œ``KEY``ã€‚

## å·¥ç¨‹åˆ›å»º
---

åœ¨VSCodeä¸­æ‰“å¼€PlatformIOæ‰©å±•åˆ›å»ºåä¸º`weather`çš„ `Espressif ESP32-S3-DevKitM-1` å·¥ç¨‹ã€‚

å…³äºè¯¦ç»†å›¾æ–‡åˆ›å»ºå·¥ç¨‹çš„è¿‡ç¨‹è¯·å‚è€ƒğŸ‘‰[RTCæ—¶é’Ÿé©±åŠ¨](ds1302.md)ç« èŠ‚çš„å·¥ç¨‹åˆ›å»ºå°èŠ‚ã€‚


## å®‰è£…é©±åŠ¨åº“
---

åœ¨é©±åŠ¨åº“ä¸‹è½½ç•Œé¢ï¼Œæœç´¢``ArduinoJson``ï¼Œå®‰è£…æ¥è‡ª``Benoit Blanchon`` çš„ ``ArduinoJson``åº“ã€‚å°†è¯¥åº“å®‰è£…åˆ°æˆ‘ä»¬çš„å·¥ç¨‹ä¹‹ä¸­ã€‚

> å…³äºè¯¦ç»†å›¾æ–‡å®‰è£…é©±åŠ¨åº“çš„è¿‡ç¨‹è¯·å‚è€ƒğŸ‘‰[RTCæ—¶é’Ÿé©±åŠ¨](ds1302.md)ç« èŠ‚çš„å®‰è£…é©±åŠ¨åº“å°èŠ‚ã€‚

å®‰è£…å®Œæˆä¹‹åï¼Œæ‰“å¼€``platformio.ini``æ–‡ä»¶ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°å·²ç»å®‰è£…ä¸Šäº†é©±åŠ¨åº“ã€‚

![å›¾ 14](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-55-51.png)  


è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå’Œé£å¤©æ°”APIè¿”å›çš„JSONæ ¼å¼æ˜¯å¸¦äº†[Gzipå‹ç¼©](https://dev.qweather.com/docs/best-practices/gzip/)çš„ã€‚

ä¸ºäº†èƒ½å¤Ÿåœ¨ESP32S3ä¸­è¿›è¡ŒGzipçš„è§£å‹æ“ä½œï¼Œå¼•ç”¨äº†githubä¸Šçš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæ¥è‡ª``pfalcon``çš„[uzlib](https://github.com/pfalcon/uzlib)ã€‚**æ„Ÿè°¢ä¼Ÿå¤§çš„å¼€æºè´¡çŒ®è€…ï¼**

![å›¾ 15](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-56-12.png)  


åœ¨æˆ‘ä»¬çš„å·¥ç¨‹ä¸­ï¼Œå»``lib``æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹``uzlib``ï¼Œå°†ä»“åº“ä¸­çš„ ``src`` æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å…¨éƒ¨æ‹‰ä¸‹æ¥ä¿å­˜åœ¨æˆ‘ä»¬åœ¨å·¥ç¨‹ä¸­æ–°å»ºçš„``uzlib``æ–‡ä»¶å¤¹ä¸‹ã€‚

![å›¾ 16](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-56-21.png)  

## ç¼–è¾‘ä»£ç 
---
åœ¨å·¥ç¨‹ä¸­çš„``src``æ–‡ä»¶å¤¹ä¸‹çš„æ–°å»º ``weather.cpp`` æ–‡ä»¶ã€‚

å¾€ ``weather.cpp`` ä¸­å†™å…¥å¦‚ä¸‹ä»£ç ï¼š

```c
#include "weather.h"

Weather::Weather(String apiKey, String location)
{
    this->apiKey = apiKey;
    this->location = location;
}

bool Weather::update()
{
    HTTPClient http;   //ç”¨äºè®¿é—®ç½‘ç»œ
    WiFiClient *stream;
    int size;
    
    http.begin("https://devapi.qweather.com/v7/weather/3d?location="+ this->location + "&key=" + this->apiKey); //è·å–è¿‘ä¸‰å¤©å¤©æ°”ä¿¡æ¯
    int httpcode = http.GET();   //å‘é€GETè¯·æ±‚
    if(httpcode > 0)
    {
        if(httpcode == HTTP_CODE_OK)
        {
            stream = http.getStreamPtr();   //è¯»å–æœåŠ¡å™¨è¿”å›çš„æ•°æ®
            size = http.getSize();
        }
    }
    else
    {
        Serial.printf("[HTTP] GET... failed, error: %s\n", http.errorToString(httpcode).c_str());
    }
    http.end();   //ç»“æŸå½“å‰è¿æ¥
    
    uint8_t inbuff[size];
    stream->readBytes(inbuff, size);
    uint8_t *outbuf = NULL;
    uint32_t out_size = 0;
    int result = ArduinoUZlib::decompress(inbuff,size, outbuf, out_size);
    deserializeJson(doc, outbuf);
    today = doc["daily"][0].as<JsonObject>();
    tomorrow = doc["daily"][1].as<JsonObject>();
    return true;
}

//è·å–å¤©æ°”æ•°æ®ä¸­çš„å½“å¤©æœ€é«˜æ°”æ¸©æ•°æ®
int Weather::getTempMax(bool is_today)
{
    if(is_today)
    {
        return today["tempMax"].as<int>();
    }
    else
    {
        return tomorrow["tempMax"].as<int>();
    }
}

//è·å–å¤©æ°”æ•°æ®ä¸­çš„å½“å¤©æœ€ä½æ°”æ¸©æ•°æ®
int Weather::getTempMin(bool is_today)
{
    if(is_today)
    {
        return today["tempMin"].as<int>();
    }
    else
    {
        return tomorrow["tempMin"].as<int>();
    }
}

//è·å–å¤©æ°”æ•°æ®ä¸­çš„å¤©æ°”æ ‡è¯†ä»£ç 
int Weather::getWeather(bool is_today, bool is_day)
{
    if(is_today)
    {
        if(is_day)
            return today["iconDay"].as<int>();
        else
            return today["iconNight"].as<int>();
    }
    else
    {
        if(is_day)
            return tomorrow["iconDay"].as<int>();
        else
            return tomorrow["iconNight"].as<int>();
    }
}
```


åœ¨å·¥ç¨‹ä¸­çš„``include``æ–‡ä»¶å¤¹ä¸‹çš„æ–°å»º ``weather.h`` æ–‡ä»¶ã€‚


å¾€ ``weather.h`` ä¸­å†™å…¥å¦‚ä¸‹ä»£ç ï¼š

```c
#ifndef _WEATHER_H
#define _WEATHER_H

#include "Arduino.h"
#include "ArduinoJson.h"
#include "ArduinoUZlib.h"
#include "HTTPClient.h"

//å®šä¹‰å¤©æ°”ç±»
class Weather
{
    public:
        Weather(String apiKey, String location);
        bool update();  //å‘é€ä¸€æ¬¡è¯·æ±‚ä¿¡æ¯ï¼Œè·å–å¤©æ°”æ•°æ®

        //åªéœ€è¦ä»Šæ˜æ—¥çš„å¤©æ°”ä¸æ¸©åº¦ï¼Œæ•…ä»…è®¾ç½®äº†ä»¥ä¸‹è‹¥å¹²å‡½æ•°
        int getTempMax(bool is_today);
        int getTempMin(bool is_today);
        int getWeather(bool is_today, bool is_day);
    private:
        String apiKey;                  //å¤©æ°”APIå¯†é’¥
        String location;                //åœ°ç‚¹
        StaticJsonDocument<2048> doc;   //Jsonå®¹å™¨
        JsonObject today, tomorrow;     //å¯æ ¹æ®è¿”å›çš„jsonä¿¡æ¯è‡ªè¡Œå®šä¹‰å…¶ä»–å¤©æ°”æ•°æ®
};

#endif
```


æ‰“å¼€å·¥ç¨‹ä¸‹çš„``src``æ–‡ä»¶å¤¹ä¸‹çš„``main.cpp``ï¼Œå¹¶ä¸”å†™å…¥å¦‚ä¸‹ä»£ç ï¼š


```c
#include <Arduino.h>
#include <WiFi.h>
#include "weather.h"  //å®šä¹‰Weatherç±»ï¼Œç”¨äºè§£æJsonæ•°æ®å¹¶è¿”å›å¤©æ°”æ•°æ®

//WIFI
#define WIFI_SSID "lckfb"         //è¦è¿æ¥çš„WIFIåç§°
#define WIFI_PASSWORD "12345678"  //è¦è¿æ¥çš„WIFIå¯†ç 
#define WIFI_RETRY_COUNT  20      //WIFIè¿æ¥é‡è¯•æ•°

//å’Œé£å¤©æ°”é¢„æŠ¥
#define USER_KEY      "d89d4706adcc4fb89d6f166cb420ee39" //å¯†é’¥
#define LOCATION_ID   "101280601"  //åœ°ç‚¹æ ‡è¯†ï¼šæ·±åœ³

int weatherid;      //æ ¹æ®å’Œé£å¤©æ°”APIè¿”å›çš„å¤©æ°”IDæ˜¾ç¤ºå¯¹åº”å¤©æ°”
bool is_day = 1;    //ç™½å¤©ä¸º1ï¼Œå¤œæ™šä¸º0
bool is_today = 1;  //ä»Šå¤©ä¸º1ï¼Œæ˜å¤©ä¸º0

//åˆ›å»ºå¤©æ°”å¯¹è±¡
Weather weather(USER_KEY, LOCATION_ID);

//æ ¹æ®å’Œé£å¤©æ°”APIè¿”å›å¤©æ°”æ ‡è¯†
void WeatherIcon(int weatherid)
{
    switch(weatherid)
    {
        case 100://ç™½å¤©æ™´
            Serial.println("ç™½å¤©æ™´\r\n");
            break;
        case 101://å¤šäº‘
        case 102://å°‘äº‘
        case 151://å¤œé—´å¤šäº‘
        case 152://å¤œé—´å°‘äº‘
        case 103://æ™´é—´å¤šäº‘
            Serial.println("å¤šäº‘\r\n");
            break;
        case 104://é˜´å¤©
            Serial.println("é˜´å¤©\r\n");
            break;
        case 150://å¤œé—´æ™´æœ—
            Serial.println("å¤œé—´æ™´æœ—\r\n");
            break;
        case 153://å¤œé—´æ™´é—´å¤šäº‘
            Serial.println("å¤œé—´å¤šäº‘\r\n");
            break;
        case 305://å°é›¨
        case 309://æ¯›æ¯›é›¨/ç»†é›¨
            Serial.println("å°é›¨\r\n");
            break;
        case 300://é˜µé›¨
        case 350://å¤œé—´é˜µé›¨
        case 306://ä¸­é›¨
        case 399://é›¨
        case 313://å†»é›¨
        case 314://å°åˆ°ä¸­é›¨
            Serial.println("é˜µé›¨\r\n");
            break;
        case 301://å¼ºé˜µé›¨
        case 351://å¤œé—´å¼ºé˜µé›¨
        case 307://å¤§é›¨
        case 308://æç«¯é™é›¨
        case 310://æš´é›¨
        case 311://å¤§æš´é›¨
        case 312://ç‰¹å¤§æš´é›¨
        case 315://ä¸­åˆ°å¤§é›¨
        case 316://å¤§åˆ°æš´é›¨
        case 317://æš´é›¨åˆ°å¤§æš´é›¨
        case 318://å¤§æš´é›¨åˆ°ç‰¹å¤§æš´é›¨
            Serial.println("å¤§é›¨\r\n");
            break;
        case 302://é›·é˜µé›¨
            Serial.println("é›·é˜µé›¨\r\n");
            break;
        case 303://å¼ºé›·é˜µé›¨
            Serial.println("å¼ºé›·é˜µé›¨\r\n");
            break;

        //é›ªå¤©
        case 400://å°é›ª
        case 401://ä¸­é›ª
        case 402://å¤§é›ª
        case 403://æš´é›ª
        case 404://é›¨å¤¹é›ª
        case 405://é›¨é›ªå¤©æ°”
        case 406://é˜µé›¨å¤¹é›ª
        case 407://é˜µé›¨å¤¹é›ª
        case 408://å°åˆ°ä¸­é›ª
        case 409://ä¸­åˆ°å¤§é›ª
        case 410://é›ª
        case 456://é˜µé›¨å¤¹é›ª
        case 457://é˜µé›ª
        case 499://é›ª
            Serial.println("é›ªå¤©\r\n");
            break;

        //é›¾éœ¾
        case 500://è–„é›¾
        case 501://é›¾
        case 509://æµ“é›¾
        case 510://å¼ºæµ“é›¾
        case 514://å¤§é›¾
        case 515://ç‰¹å¼ºæµ“é›¾
            Serial.println("é›¾å¤©\r\n");
            break;
        case 502://éœ¾
        case 511://ä¸­åº¦éœ¾
        case 512://é‡åº¦éœ¾
        case 513://ä¸¥é‡éœ¾
            Serial.println("é›¾éœ¾\r\n");
            break;
    }
}

void setup() 
{
  int count = 0;
  char disp_buf[50]={0};

  //ä¸²å£åˆå§‹åŒ–
  Serial.begin(9600);

  //å°è¯•è¿æ¥WIFIç½‘ç»œ
  WiFi.begin(WIFI_SSID, WIFI_PASSWORD); 
  //å°è¯•è¿æ¥ç›´è‡³è¶…æ—¶
  while (WiFi.status() != WL_CONNECTED) 
  {
    count++;
    if (count > WIFI_RETRY_COUNT)
    {
      Serial.println("\r\nconnection failed.\r\n");
      break;
    }
    delay(500);
    Serial.print(".");
  }

  //è·å–å¤©æ°”æ•°æ®
  weather.update();

  //WIFIæ–­å¼€è¿æ¥
  WiFi.disconnect();

  //æ˜¾ç¤ºæœ€ä½ä¸æœ€é«˜æ¸©åº¦
  sprintf(disp_buf, "TempMin = %d", weather.getTempMin(is_today));
  Serial.println(disp_buf);
  sprintf(disp_buf, "TempMax = %d", weather.getTempMax(is_today));
  Serial.println(disp_buf);

  //æ˜¾ç¤ºå¤©æ°”æ ‡è¯†ä»£ç 
  sprintf(disp_buf, "WeatherCode = %d", weather.getWeather(is_today, is_day));
  Serial.println(disp_buf);

  //æ ¹æ®å¤©æ°”æ ‡è¯†ä»£ç ç¡®å®šå¤©æ°”
  WeatherIcon(weather.getWeather(is_today, is_day));
}

void loop() 
{
  delay(1000);
}

```

## ä»£ç éªŒè¯
---

ä»£ç ç¼–å†™å®Œæˆä¹‹åï¼Œå°†ESP32S3å¼€å‘æ¿æ¥å…¥ç”µè„‘ä¸‹è½½ä»£ç ï¼Œç„¶åæ‰“å¼€ä¸²å£ç›‘è§†å™¨æŸ¥çœ‹ç°è±¡ã€‚

> ä¸‹è½½æ­¥éª¤è¯·å‚è€ƒğŸ‘‰[RTCæ—¶é’Ÿé©±åŠ¨](ds1302.md)ç« èŠ‚çš„ä»£ç éªŒè¯å°èŠ‚ã€‚

å®é™…è·å–å¤©æ°”æ•°æ®çš„æ•ˆæœå¦‚ä¸‹ï¼š

æœ€ä½æ¸©åº¦26ï¼Œæœ€é«˜æ¸©åº¦31ï¼Œå¤©æ°”ä»£ç ä¸º307ï¼Œå¯¹åº”çš„å°±æ˜¯å¤§é›¨ã€‚

![å›¾ 17](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-57-17.png)  


æŸ¥çœ‹å’Œé£å¤©æ°”çš„APIä¸­[å¤©æ°”ä»£ç è¯´æ˜](https://dev.qweather.com/docs/resource/icons/)ï¼Œç¡®è®¤æ•°æ®æ˜¯æ­£ç¡®çš„ã€‚

![å›¾ 18](../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-57-22.png)  

>! è¯´æ˜ï¼šå¦‚æœä½ æ ¹æ®ä»£ç æ“ä½œè¿è¡Œä¸èµ·æ¥ï¼Œå¯ä»¥ä¸‹è½½ğŸ‘‰[ä¾‹ç¨‹](https://gitee.com/laoguaige/esp32-s3-r8-n8-pixel-clock/tree/master/example/weather)çœ‹çœ‹

