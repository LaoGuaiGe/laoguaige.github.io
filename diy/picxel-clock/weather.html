<!DOCTYPE html>

<html lang="en"  class="">


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="keywords" content="keyword1, keyword2">
    
    
    <meta name="description" content="description for this article">
    
    <meta name="generator" content="teedoc">
    <meta name="theme" content="teedoc-plugin-theme-default">
    
        
        <meta name="markdown-generator" content="teedoc-plugin-markdown-parser">
        
        <script>
MathJax = {"loader": {"load": ["output/svg"]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "svg": {"fontCache": "global"}};
</script>
        
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
        <meta name="html-generator" content="teedoc-plugin-jupyter-notebook-parser">
        
        <script src="/static/js/theme_default/pre_main.js"></script>
        
        <link rel="stylesheet" href="/static/css/theme_default/prism.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/viewer.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/dark.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/light.css" type="text/css"/>
        
        <script src="/static/js/theme_default/jquery.min.js"></script>
        
        <script src="/static/js/theme_default/split.js"></script>
        
        <link rel="stylesheet" href="/static/css/gitalk/gitalk.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/gitalk/custom_gitalk.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/custom.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/search/style.css" type="text/css"/>
        
    
    
    <title>è·å–å¤©æ°”æƒ…å†µ - Hdochub</title>
    
    <script type="text/javascript">js_vars = {"teedoc-plugin-ad-hint": {"type": "hint", "label": "â˜†", "content": "è¿™é‡Œæ˜¯è€æ€ªé¸½çš„ä¸ªäººæŠ€æœ¯æ–‡æ¡£è®°å½•ä¸­å¿ƒ</br>å–œæ¬¢é¡¹ç›®è¯·<a target=\"_blank\" href=\"https://github.com/LaoGuaiGe/laoguaige.github.io\">ç‚¹ä¸‹ â˜† star </a>å“¦~ğŸ¦€ğŸ¦€", "show_times": 2, "show_after_s": 432000, "date": "2021-11-16 14:40", "color": "#a0421d", "link_color": "#e53935", "link_bg_color": "#e6ae5c", "bg_color": "#ffcf89", "color_hover": "white", "bg_color_hover": "#f57c00", "close_color": "#eab971"}}</script>
    <script type="text/javascript">metadata = {"tags": [], "date": "2024-12-05", "update": [{"date": "2024-12-05", "author": "è€æ€ªé¸½", "version": "1.0.1", "content": "æ›´æ–°äº†åŸºæœ¬æ–‡æ¡£"}], "ts": 1733356800, "author": "", "brief": "", "cover": "", "show_source": false}</script>
</head>


<body class="type_doc">
    
    <div id="navbar">
        <div id="navbar_menu">
            <a class="site_title" href="/">
                
                    <img class="site_logo" src="/static/images/logo.png" alt="HDocHub logo">
                
                
                    <h2>HDocHub</h2>
                
        </a>
            <a id="navbar_menu_btn"></a>
        </div>
        <div id="navbar_items">
            <div>
                <ul id="nav_left">
<li class=""><a  href="/">é¦–é¡µ</a></li>
<li class=""><a  href="/c-basics/">Cè¯­è¨€</a></li>
<li class=""><a  href="/python/">Python</a></li>
<li class=""><a  href="/linux/">Linux</a></li>
<li class=""><a  href="/markdown/">MarkDown</a></li>
<li class=""><a  href="/git/">Git</a></li>
<li class=""><a  href="/mcu/">å•ç‰‡æœº</a></li>
<li class=""><a  href="/module/">ç”µå­æ¨¡å—é©±åŠ¨åˆé›†</a></li>
<li class="active"><a  href="/diy/">DIYé¡¹ç›®</a></li>
</ul>

            </div>
            <div>
                <ul id="nav_right">
<li class=""><a target="_blank" href="https://github.com/LaoGuaiGe/laoguaige.github.io">github</a></li>
</ul>

                <ul class="nav_plugins"><li><a id="themes" class="light"></a></li></ul><ul class="nav_plugins"><li><a id="search"><span class="icon"></span><span class="placeholder">æœç´¢</span>
                            <div id="search_hints">
                                <span id="search_input_hint">è¾“å…¥å…³é”®è¯ï¼Œå¤šå…³é”®è¯ç©ºæ ¼éš”å¼€</span>
                                <span id="search_loading_hint">æ­£åœ¨åŠ è½½ï¼Œè¯·ç¨å€™ã€‚ã€‚ã€‚</span>
                                <span id="search_download_err_hint">ä¸‹è½½æ–‡ä»¶å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•æˆ–æ£€æŸ¥ç½‘ç»œ</span>
                                <span id="search_other_docs_result_hint">æ¥è‡ªå…¶å®ƒæ–‡æ¡£çš„ç»“æœ</span>
                                <span id="search_curr_doc_result_hint">å½“å‰æ–‡æ¡£æœç´¢ç»“æœ</span>
                            </div></a></li></ul>
            </div>
        </div>
    </div>
    
    <div id="wrapper">
        <div id="sidebar_wrapper">
            <div id="sidebar">
                <div id="sidebar_title">
                    
                </div>
                <ul class="show">
<li class="not_active with_link"><a href="/diy/index.html"><span class="label">é¡¹ç›®é›†åˆ</span><span class=""></span></a></li>
<li class="active_parent with_link"><a href="/diy/picxel-clock/basic.html"><span class="label">ç‰©è”ç½‘åƒç´ æ—¶é’Ÿâ°</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active with_link"><a href="/diy/picxel-clock/basic.html"><span class="label">âœ¨é¡¹ç›®ä¿¡æ¯</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/diy/picxel-clock/download.html"><span class="label">â¬‡ï¸èµ„æ–™ä¸‹è½½</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/diy/picxel-clock/hardware.html"><span class="label">0. ç¡¬ä»¶è®¾è®¡</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/diy/picxel-clock/install.html"><span class="label">1. è½¯ä»¶ç¯å¢ƒæ­å»º</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/diy/picxel-clock/ds1302.html"><span class="label">2. RTCæ—¶é’Ÿé©±åŠ¨</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/diy/picxel-clock/dht11.html"><span class="label">3. æ¸©æ¹¿åº¦é‡‡é›†</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/diy/picxel-clock/ledmatrix.html"><span class="label">4. å½©ç¯é©±åŠ¨</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/diy/picxel-clock/ntptime.html"><span class="label">5. è·å–ç½‘ç»œæ—¶é—´</span><span class=""></span></a></li>
<li class="active with_link"><a href="/diy/picxel-clock/weather.html"><span class="label">6. è·å–å¤©æ°”æƒ…å†µ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/diy/picxel-clock/led-oscillating.html"><span class="label">7. å®ç°FFTéŸ³å¾‹ç¯</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/diy/picxel-clock/voice.html"><span class="label">8. è¯­éŸ³è¯†åˆ«ä¸æ’­æŠ¥</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active with_link"><a href="/diy/wiki-web/basic.html"><span class="label">WIKIç½‘ç«™æ­å»ºğŸŒ</span><span class=""></span></a></li>
</ul>

            </div>
        </div>
        <div id="article">
            <div id="menu_wrapper">
                <div id="menu">
                </div>
            </div>
            <div id="content_wrapper">
                <div id="content_body">
                    <div id="article_head">
                        <div id="article_title">
                            
                            <h1>è·å–å¤©æ°”æƒ…å†µ</h1>
                            
                        </div>
                        <div id="article_tags">
                            <ul>
                            
                            </ul>
                        </div>
                        <div id="article_info">
                        <div id="article_info_left">
                            <span class="article_author">
                                
                            </span>
                            
                                <span class="article_date" title="Last modify date: 2024-12-05">
                                    2024-12-05
                                </span>
                            
                        </div>
                        <div id="article_info_right">
                            
                        </div>
                        </div>
                    </div>
                    <div id="article_tools">
                        <span></span>
                        <span id="toc_btn"></span>
                    </div>
                    <div id="update_history">
                        
                        
                        <details open>
                        
                            <summary>Update history</summary>
                            <div>
                                <table>
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Version</th>
                                                <th>Author</th>
                                                <th>Update content</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            
                                                <tr>
                                                    <td>2024-12-05</td>
                                                    <td>1.0.1</td>
                                                    <td>è€æ€ªé¸½</td>
                                                    <td>
                                                    
                                                        æ›´æ–°äº†åŸºæœ¬æ–‡æ¡£
                                                    
                                                    </td>
                                                </tr>
                                            
                                        </tbody>
                                </table>
                            </div>
                        </details>
                        
                    </div>
                    <div id="article_content">
                        
                            <h2 id="%E7%A1%AC%E4%BB%B6%E5%87%86%E5%A4%87">ç¡¬ä»¶å‡†å¤‡</h2>
<hr />
<p>ä½ åªéœ€è¦æœ‰ä¸€ä¸ªESP32S3å¼€å‘æ¿ã€‚æˆ‘ç›®å‰ä½¿ç”¨çš„æ˜¯ï¼šç«‹åˆ›å¼€å‘æ¿çš„ç«‹åˆ›Â·ESP32S3R8N8å¼€å‘æ¿ã€‚</p>
<blockquote>
<p><strong>è´­ä¹°åœ°å€ï¼š</strong><a href="https://item.szlcsc.com/22034693.html?fromZone=s_s__%2522%25E7%25AB%258B%25E5%2588%259B%25E5%25BC%2580%25E5%258F%2591%25E6%259D%25BF%2522"  target="_blank">ç«‹åˆ›Â·ESP32S3R8N8 å¼€å‘æ¿</a></p>
</blockquote>
<h2 id="%E5%92%8C%E9%A3%8E%E5%A4%A9%E6%B0%94API">å’Œé£å¤©æ°”API</h2>
<hr />
<h3 id="%E5%92%8C%E9%A3%8E%E5%A4%A9%E6%B0%94%E4%BB%8B%E7%BB%8D">å’Œé£å¤©æ°”ä»‹ç»</h3>
<blockquote>
<p><a href="https://www.qweather.com/"  target="_blank">å’Œâ»›å¤©æ°”</a>æ˜¯ä¸­å›½é¢†å…ˆçš„æ°”è±¡ç§‘æŠ€æœåŠ¡å•†ã€å›½å®¶é«˜æ–°æŠ€æœ¯ ä¼ä¸šï¼Œè‡´åŠ›äºè¿ç”¨å…ˆè¿›æ°”è±¡æ¨¡å‹ç»“åˆå¤§æ•°æ®ã€äººå·¥æ™ºèƒ½ æŠ€æœ¯å‘å±•æ™ºæ…§å‹æ°”è±¡æœåŠ¡ã€‚</p>
</blockquote>
<p>ä»–ä»¬çš„ä¸šåŠ¡åŒ…æ‹¬æ°”è±¡æ•°æ®åˆ†å‘ã€åœ°ç†ä¿¡æ¯ã€æ°”è±¡å¯è§† åŒ–ã€ä¸ªäººæ°”è±¡æœåŠ¡ç­‰ï¼Œåœ¨å…¨çƒ10ä¸ªå›½å®¶å»ºæœ‰æ•°æ®ä¸­å¿ƒï¼Œ ä¸º300ä½™å®¶ä¸­å›½åŠå…¨çƒä¼ä¸šã€50ä¸‡å¼€å‘è€…æä¾›ä¼˜è´¨çš„æ•° æ®æœåŠ¡ã€‚</p>
<p><strong>å¦å¤–çš„è¯</strong></p>
<blockquote>
<p>å’Œé£å¤©æ°”æ”¯æŒç”¨æˆ·å…è´¹ä½¿ç”¨è®¢é˜…ï¼Œåªæ˜¯ä¸€ä¸ªç”¨æˆ·åªèƒ½åˆ›å»ºä¸€ä¸ªé¡¹ç›®APIï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬æ¥è¯´å·²ç»è¶³å¤Ÿäº†ï¼Œæ„Ÿè°¢å’Œé£å¤©æ°”ï¼</p>
</blockquote>
<h3 id="%E5%88%9B%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%A4%A9%E6%B0%94API">åˆ›å»ºè‡ªå·±çš„å¤©æ°”API</h3>
<p>è¯·å‰å¾€ <a href="https://dev.qweather.com/"  target="_blank">å’Œé£å¤©æ°”API</a> å®˜ç½‘ï¼Œæ³¨å†Œè´¦å·å¹¶è¿›å…¥æ§åˆ¶å°ã€‚</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-51-48.png" alt="å›¾ 0" /></p>
<p>å…³äºå’Œé£å¤©æ°”çš„APIä»‹ç»å’Œå¼€å‘æ–‡æ¡£ï¼Œå‚è€ƒæ§åˆ¶å°å¤„çš„ä»‹ç»ï¼š</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-52-04.png" alt="å›¾ 2" /></p>
<p>å¼€å§‹åˆ›å»ºå±äºæˆ‘ä»¬çš„API !</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-51-58.png" alt="å›¾ 1" /></p>
<p>å’Œé£å¤©æ°”é¡¹ç›®åˆ›å»ºå‚æ•°å¡«å†™ï¼š</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-52-18.png" alt="å›¾ 3" /></p>
<p>å®Œæˆåˆ›å»ºï¼</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-52-23.png" alt="å›¾ 4" /></p>
<h3 id="API%E4%BB%8B%E7%BB%8D">APIä»‹ç»</h3>
<p>å’Œé£å¤©æ°”çš„ <a href="https://dev.qweather.com/docs/api/"  target="_blank">APIä»‹ç»ç½‘é¡µ</a> å¦‚ä¸‹ï¼š</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-52-33.png" alt="å›¾ 5" /></p>
<p>æœ¬æ–‡å°†ç”¨çš„APIæ˜¯<code>åŸå¸‚å¤©æ°” -&gt; æ¯æ—¥å¤©æ°”é¢„æŠ¥ -&gt; 3å¤©é¢„æŠ¥API</code> ã€‚<a href="https://dev.qweather.com/docs/api/weather/weather-daily-forecast/"  target="_blank">ã€APIçš„è¯¦ç»†ä»‹ç»é¡µç‚¹æˆ‘ã€‘</a></p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-52-38.png" alt="å›¾ 6" /></p>
<blockquote>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ˜¯å…è´¹è®¢é˜…ï¼Œè¦å°†API Hostæ›´æ”¹ä¸º <code>devapi.qweather.com</code>ã€‚</strong></p>
</blockquote>
<p>è¿™é‡Œä»¥è·å–æ·±åœ³<code>3å¤©çš„å¤©æ°”é¢„æŠ¥ä¸ºä¾‹</code>ï¼Œå…³é”®çš„APIå‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š</p>

<pre class="language-html"><code class="language-html">https://devapi.qweather.com/v7/weather/3d?location=101280601&amp;key=YOUR_KEY
</code></pre>
<blockquote>
<p>è¯·æ±‚å‚æ•°åŒ…æ‹¬å¿…é€‰å’Œå¯é€‰å‚æ•°ï¼Œå‚æ•°ä¹‹é—´ä½¿ç”¨&amp;è¿›è¡Œåˆ†éš”ã€‚è¿™é‡Œåªç»™å¤§å®¶ä»‹ç»å¿…å¡«é¡¹ã€‚</p>
</blockquote>
<p><strong>1. key(å¿…é€‰)</strong> ï¼š ç”¨æˆ·è®¤è¯keyï¼Œè¯·å‚è€ƒ<a href="https://dev.qweather.com/docs/configuration/project-and-key/"  target="_blank">å¦‚ä½•è·å–ä½ çš„KEY</a>ã€‚<br />
<strong>2. location(å¿…é€‰)</strong> ï¼š éœ€è¦æŸ¥è¯¢åœ°åŒºçš„<a href="https://dev.qweather.com/docs/resource/glossary/#locationid"  target="_blank">LocationID</a>æˆ–ä»¥è‹±æ–‡é€—å·åˆ†éš”çš„ç»åº¦,çº¬åº¦åæ ‡ï¼ˆåè¿›åˆ¶ï¼Œæœ€å¤šæ”¯æŒå°æ•°ç‚¹åä¸¤ä½ï¼‰ï¼ŒLocationIDå¯é€šè¿‡GeoAPIè·å–ã€‚ä¾‹å¦‚ location=101010100 æˆ– location=116.41,39.92</p>
<p>å…³äºè¿™ä¸ªLocationIDéœ€è¦å„ä½è‡ªè¡Œæ ¹æ®å’Œé£å¤©æ°”å®˜æ–¹çš„githubåœ°å€æŸ¥è¯¢ï¼Œè¿™é‡Œæˆ‘æ‰¾åˆ°æ·±åœ³çš„LocationIDä¸ºï¼š<code>101280601</code></p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-52-56.png" alt="å›¾ 7" /></p>
<h3 id="%E6%89%8B%E5%8A%A8%E9%AA%8C%E8%AF%81API%E6%98%AF%E5%90%A6%E6%AD%A3%E7%A1%AE">æ‰‹åŠ¨éªŒè¯APIæ˜¯å¦æ­£ç¡®</h3>
<p>é¦–å…ˆå›åˆ°ä½ çš„å’Œé£å¤©æ°”ç®¡ç†å°ã€‚ä½ ä¼šçœ‹åˆ°ä½ æ–°å»ºçš„é¡¹ç›®ã€‚</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-53-03.png" alt="å›¾ 8" /></p>
<p>å¤åˆ¶ä½ çš„å¯†é’¥<code>KEY</code>ã€‚</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-53-09.png" alt="å›¾ 9" /></p>
<p>ç„¶åå°†ä½ çš„<code>KEY</code>å¡«å……åˆ°ä¸‹æ–¹APIçš„<code>YOUR_KEY</code>ä¸­</p>
<blockquote>
<p>ä¸‹æ–¹è¿™ä¸ªæ˜¯è·å–æ·±åœ³3å¤©çš„å¤©æ°”é¢„æŠ¥APIï¼Œåªå‰©KEYæ²¡æœ‰å¡«å†™</p>
</blockquote>

<pre class="language-html"><code class="language-html">https://devapi.qweather.com/v7/weather/3d?location=101280601&amp;key=YOUR_KEY
</code></pre>
<p>ä¾‹å¦‚æˆ‘çš„KEYæ˜¯ <code>ABCasdsdgsdfgdsgdfgdf</code>ï¼Œåˆ™æˆ‘çš„APIæ˜¯</p>

<pre class="language-heml"><code class="language-heml">https://devapi.qweather.com/v7/weather/3d?location=101280601&amp;key=ABCasdsdgsdfgdsgdfgdf
</code></pre>
<p>å¡«å†™ä½ çš„<code>KEY</code>åï¼Œç›´æ¥å¤åˆ¶è¯¥<code>API</code>ï¼Œå°†å®ƒä½œä¸ºç½‘å€è·³è½¬åˆ°å¯¹åº”é¡µé¢ï¼Œä½ å°±ä¼šçœ‹çš„è¿”å›çš„å¤©æ°”æ•°æ®ã€‚</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-53-50.png" alt="å›¾ 10" /></p>
<p>å…³äºAPIè¿”å›çš„æ•°æ®å…·ä½“çš„æ„æ€æ˜¯ä»€ä¹ˆï¼Œå‚è€ƒè¯¥<a href="https://dev.qweather.com/docs/api/weather/weather-daily-forecast/"  target="_blank">APIçš„ä»‹ç»é¡µ</a>ã€‚</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-53-57.png" alt="å›¾ 11" /></p>
<p><strong>æ ¹æ®è¿”å›çš„å‚æ•°è¯´æ˜ï¼Œè¿™é‡Œæˆ‘å…³æ³¨çš„æ˜¯4ä¸ªæ•°æ®ï¼š</strong></p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-54-03.png" alt="å›¾ 12" /></p>
<p>å›¾æ ‡ä»£ç çš„è¯´æ˜ï¼šè¿”å›çš„æ•°æ®ä¸­å…³äºå¤©æ°”çš„è¯´æ˜åªæœ‰ç©ºè½è½çš„æ•°å­—ï¼Œè¿™äº›æ•°å­—åœ¨APIè¯´æ˜ä¸­ä»£è¡¨ç€å„ä¸ªå¤©æ°”æƒ…å†µã€‚<a href="https://dev.qweather.com/docs/resource/icons/"  target="_blank">æ•°å­—å¯¹åº”çš„å¤©æ°”æƒ…å†µé“¾æ¥ã€‚</a></p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-54-11.png" alt="å›¾ 13" /></p>
<p>åˆ°è¿™é‡Œæˆ‘ä»¬å°±å·²ç»æ˜¯å‡†å¤‡å¥½äº†ï¼Œæ¥ä¸‹æ¥å¯ä»¥ä¸Šå·¥ç¨‹ä»£ç äº†ã€‚è¯·å‡†å¤‡å¥½ä½ çš„<code>å®Œæ•´API</code>å’Œ<code>KEY</code>ã€‚</p>
<h2 id="%E5%B7%A5%E7%A8%8B%E5%88%9B%E5%BB%BA">å·¥ç¨‹åˆ›å»º</h2>
<hr />
<p>åœ¨VSCodeä¸­æ‰“å¼€PlatformIOæ‰©å±•åˆ›å»ºåä¸º<code>weather</code>çš„ <code>Espressif ESP32-S3-DevKitM-1</code> å·¥ç¨‹ã€‚</p>
<p>å…³äºè¯¦ç»†å›¾æ–‡åˆ›å»ºå·¥ç¨‹çš„è¿‡ç¨‹è¯·å‚è€ƒğŸ‘‰<a href="ds1302.html"  >RTCæ—¶é’Ÿé©±åŠ¨</a>ç« èŠ‚çš„å·¥ç¨‹åˆ›å»ºå°èŠ‚ã€‚</p>
<h2 id="%E5%AE%89%E8%A3%85%E9%A9%B1%E5%8A%A8%E5%BA%93">å®‰è£…é©±åŠ¨åº“</h2>
<hr />
<p>åœ¨é©±åŠ¨åº“ä¸‹è½½ç•Œé¢ï¼Œæœç´¢<code>ArduinoJson</code>ï¼Œå®‰è£…æ¥è‡ª<code>Benoit Blanchon</code> çš„ <code>ArduinoJson</code>åº“ã€‚å°†è¯¥åº“å®‰è£…åˆ°æˆ‘ä»¬çš„å·¥ç¨‹ä¹‹ä¸­ã€‚</p>
<blockquote>
<p>å…³äºè¯¦ç»†å›¾æ–‡å®‰è£…é©±åŠ¨åº“çš„è¿‡ç¨‹è¯·å‚è€ƒğŸ‘‰<a href="ds1302.html"  >RTCæ—¶é’Ÿé©±åŠ¨</a>ç« èŠ‚çš„å®‰è£…é©±åŠ¨åº“å°èŠ‚ã€‚</p>
</blockquote>
<p>å®‰è£…å®Œæˆä¹‹åï¼Œæ‰“å¼€<code>platformio.ini</code>æ–‡ä»¶ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°å·²ç»å®‰è£…ä¸Šäº†é©±åŠ¨åº“ã€‚</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-55-51.png" alt="å›¾ 14" /></p>
<p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå’Œé£å¤©æ°”APIè¿”å›çš„JSONæ ¼å¼æ˜¯å¸¦äº†<a href="https://dev.qweather.com/docs/best-practices/gzip/"  target="_blank">Gzipå‹ç¼©</a>çš„ã€‚</p>
<p>ä¸ºäº†èƒ½å¤Ÿåœ¨ESP32S3ä¸­è¿›è¡ŒGzipçš„è§£å‹æ“ä½œï¼Œå¼•ç”¨äº†githubä¸Šçš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæ¥è‡ª<code>pfalcon</code>çš„<a href="https://github.com/pfalcon/uzlib"  target="_blank">uzlib</a>ã€‚<strong>æ„Ÿè°¢ä¼Ÿå¤§çš„å¼€æºè´¡çŒ®è€…ï¼</strong></p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-56-12.png" alt="å›¾ 15" /></p>
<p>åœ¨æˆ‘ä»¬çš„å·¥ç¨‹ä¸­ï¼Œå»<code>lib</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹<code>uzlib</code>ï¼Œå°†ä»“åº“ä¸­çš„ <code>src</code> æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å…¨éƒ¨æ‹‰ä¸‹æ¥ä¿å­˜åœ¨æˆ‘ä»¬åœ¨å·¥ç¨‹ä¸­æ–°å»ºçš„<code>uzlib</code>æ–‡ä»¶å¤¹ä¸‹ã€‚</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-56-21.png" alt="å›¾ 16" /></p>
<h2 id="%E7%BC%96%E8%BE%91%E4%BB%A3%E7%A0%81">ç¼–è¾‘ä»£ç </h2>
<hr />
<p>åœ¨å·¥ç¨‹ä¸­çš„<code>src</code>æ–‡ä»¶å¤¹ä¸‹çš„æ–°å»º <code>weather.cpp</code> æ–‡ä»¶ã€‚</p>
<p>å¾€ <code>weather.cpp</code> ä¸­å†™å…¥å¦‚ä¸‹ä»£ç ï¼š</p>

<pre class="language-c"><code class="language-c">#include &quot;weather.h&quot;

Weather::Weather(String apiKey, String location)
{
    this-&gt;apiKey = apiKey;
    this-&gt;location = location;
}

bool Weather::update()
{
    HTTPClient http;   //ç”¨äºè®¿é—®ç½‘ç»œ
    WiFiClient *stream;
    int size;

    http.begin(&quot;https://devapi.qweather.com/v7/weather/3d?location=&quot;+ this-&gt;location + &quot;&amp;key=&quot; + this-&gt;apiKey); //è·å–è¿‘ä¸‰å¤©å¤©æ°”ä¿¡æ¯
    int httpcode = http.GET();   //å‘é€GETè¯·æ±‚
    if(httpcode &gt; 0)
    {
        if(httpcode == HTTP_CODE_OK)
        {
            stream = http.getStreamPtr();   //è¯»å–æœåŠ¡å™¨è¿”å›çš„æ•°æ®
            size = http.getSize();
        }
    }
    else
    {
        Serial.printf(&quot;[HTTP] GET... failed, error: %s\n&quot;, http.errorToString(httpcode).c_str());
    }
    http.end();   //ç»“æŸå½“å‰è¿æ¥

    uint8_t inbuff[size];
    stream-&gt;readBytes(inbuff, size);
    uint8_t *outbuf = NULL;
    uint32_t out_size = 0;
    int result = ArduinoUZlib::decompress(inbuff,size, outbuf, out_size);
    deserializeJson(doc, outbuf);
    today = doc[&quot;daily&quot;][0].as&lt;JsonObject&gt;();
    tomorrow = doc[&quot;daily&quot;][1].as&lt;JsonObject&gt;();
    return true;
}

//è·å–å¤©æ°”æ•°æ®ä¸­çš„å½“å¤©æœ€é«˜æ°”æ¸©æ•°æ®
int Weather::getTempMax(bool is_today)
{
    if(is_today)
    {
        return today[&quot;tempMax&quot;].as&lt;int&gt;();
    }
    else
    {
        return tomorrow[&quot;tempMax&quot;].as&lt;int&gt;();
    }
}

//è·å–å¤©æ°”æ•°æ®ä¸­çš„å½“å¤©æœ€ä½æ°”æ¸©æ•°æ®
int Weather::getTempMin(bool is_today)
{
    if(is_today)
    {
        return today[&quot;tempMin&quot;].as&lt;int&gt;();
    }
    else
    {
        return tomorrow[&quot;tempMin&quot;].as&lt;int&gt;();
    }
}

//è·å–å¤©æ°”æ•°æ®ä¸­çš„å¤©æ°”æ ‡è¯†ä»£ç 
int Weather::getWeather(bool is_today, bool is_day)
{
    if(is_today)
    {
        if(is_day)
            return today[&quot;iconDay&quot;].as&lt;int&gt;();
        else
            return today[&quot;iconNight&quot;].as&lt;int&gt;();
    }
    else
    {
        if(is_day)
            return tomorrow[&quot;iconDay&quot;].as&lt;int&gt;();
        else
            return tomorrow[&quot;iconNight&quot;].as&lt;int&gt;();
    }
}
</code></pre>
<p>åœ¨å·¥ç¨‹ä¸­çš„<code>include</code>æ–‡ä»¶å¤¹ä¸‹çš„æ–°å»º <code>weather.h</code> æ–‡ä»¶ã€‚</p>
<p>å¾€ <code>weather.h</code> ä¸­å†™å…¥å¦‚ä¸‹ä»£ç ï¼š</p>

<pre class="language-c"><code class="language-c">#ifndef _WEATHER_H
#define _WEATHER_H

#include &quot;Arduino.h&quot;
#include &quot;ArduinoJson.h&quot;
#include &quot;ArduinoUZlib.h&quot;
#include &quot;HTTPClient.h&quot;

//å®šä¹‰å¤©æ°”ç±»
class Weather
{
    public:
        Weather(String apiKey, String location);
        bool update();  //å‘é€ä¸€æ¬¡è¯·æ±‚ä¿¡æ¯ï¼Œè·å–å¤©æ°”æ•°æ®

        //åªéœ€è¦ä»Šæ˜æ—¥çš„å¤©æ°”ä¸æ¸©åº¦ï¼Œæ•…ä»…è®¾ç½®äº†ä»¥ä¸‹è‹¥å¹²å‡½æ•°
        int getTempMax(bool is_today);
        int getTempMin(bool is_today);
        int getWeather(bool is_today, bool is_day);
    private:
        String apiKey;                  //å¤©æ°”APIå¯†é’¥
        String location;                //åœ°ç‚¹
        StaticJsonDocument&lt;2048&gt; doc;   //Jsonå®¹å™¨
        JsonObject today, tomorrow;     //å¯æ ¹æ®è¿”å›çš„jsonä¿¡æ¯è‡ªè¡Œå®šä¹‰å…¶ä»–å¤©æ°”æ•°æ®
};

#endif
</code></pre>
<p>æ‰“å¼€å·¥ç¨‹ä¸‹çš„<code>src</code>æ–‡ä»¶å¤¹ä¸‹çš„<code>main.cpp</code>ï¼Œå¹¶ä¸”å†™å…¥å¦‚ä¸‹ä»£ç ï¼š</p>

<pre class="language-c"><code class="language-c">#include &lt;Arduino.h&gt;
#include &lt;WiFi.h&gt;
#include &quot;weather.h&quot;  //å®šä¹‰Weatherç±»ï¼Œç”¨äºè§£æJsonæ•°æ®å¹¶è¿”å›å¤©æ°”æ•°æ®

//WIFI
#define WIFI_SSID &quot;lckfb&quot;         //è¦è¿æ¥çš„WIFIåç§°
#define WIFI_PASSWORD &quot;12345678&quot;  //è¦è¿æ¥çš„WIFIå¯†ç 
#define WIFI_RETRY_COUNT  20      //WIFIè¿æ¥é‡è¯•æ•°

//å’Œé£å¤©æ°”é¢„æŠ¥
#define USER_KEY      &quot;d89d4706adcc4fb89d6f166cb420ee39&quot; //å¯†é’¥
#define LOCATION_ID   &quot;101280601&quot;  //åœ°ç‚¹æ ‡è¯†ï¼šæ·±åœ³

int weatherid;      //æ ¹æ®å’Œé£å¤©æ°”APIè¿”å›çš„å¤©æ°”IDæ˜¾ç¤ºå¯¹åº”å¤©æ°”
bool is_day = 1;    //ç™½å¤©ä¸º1ï¼Œå¤œæ™šä¸º0
bool is_today = 1;  //ä»Šå¤©ä¸º1ï¼Œæ˜å¤©ä¸º0

//åˆ›å»ºå¤©æ°”å¯¹è±¡
Weather weather(USER_KEY, LOCATION_ID);

//æ ¹æ®å’Œé£å¤©æ°”APIè¿”å›å¤©æ°”æ ‡è¯†
void WeatherIcon(int weatherid)
{
    switch(weatherid)
    {
        case 100://ç™½å¤©æ™´
            Serial.println(&quot;ç™½å¤©æ™´\r\n&quot;);
            break;
        case 101://å¤šäº‘
        case 102://å°‘äº‘
        case 151://å¤œé—´å¤šäº‘
        case 152://å¤œé—´å°‘äº‘
        case 103://æ™´é—´å¤šäº‘
            Serial.println(&quot;å¤šäº‘\r\n&quot;);
            break;
        case 104://é˜´å¤©
            Serial.println(&quot;é˜´å¤©\r\n&quot;);
            break;
        case 150://å¤œé—´æ™´æœ—
            Serial.println(&quot;å¤œé—´æ™´æœ—\r\n&quot;);
            break;
        case 153://å¤œé—´æ™´é—´å¤šäº‘
            Serial.println(&quot;å¤œé—´å¤šäº‘\r\n&quot;);
            break;
        case 305://å°é›¨
        case 309://æ¯›æ¯›é›¨/ç»†é›¨
            Serial.println(&quot;å°é›¨\r\n&quot;);
            break;
        case 300://é˜µé›¨
        case 350://å¤œé—´é˜µé›¨
        case 306://ä¸­é›¨
        case 399://é›¨
        case 313://å†»é›¨
        case 314://å°åˆ°ä¸­é›¨
            Serial.println(&quot;é˜µé›¨\r\n&quot;);
            break;
        case 301://å¼ºé˜µé›¨
        case 351://å¤œé—´å¼ºé˜µé›¨
        case 307://å¤§é›¨
        case 308://æç«¯é™é›¨
        case 310://æš´é›¨
        case 311://å¤§æš´é›¨
        case 312://ç‰¹å¤§æš´é›¨
        case 315://ä¸­åˆ°å¤§é›¨
        case 316://å¤§åˆ°æš´é›¨
        case 317://æš´é›¨åˆ°å¤§æš´é›¨
        case 318://å¤§æš´é›¨åˆ°ç‰¹å¤§æš´é›¨
            Serial.println(&quot;å¤§é›¨\r\n&quot;);
            break;
        case 302://é›·é˜µé›¨
            Serial.println(&quot;é›·é˜µé›¨\r\n&quot;);
            break;
        case 303://å¼ºé›·é˜µé›¨
            Serial.println(&quot;å¼ºé›·é˜µé›¨\r\n&quot;);
            break;

        //é›ªå¤©
        case 400://å°é›ª
        case 401://ä¸­é›ª
        case 402://å¤§é›ª
        case 403://æš´é›ª
        case 404://é›¨å¤¹é›ª
        case 405://é›¨é›ªå¤©æ°”
        case 406://é˜µé›¨å¤¹é›ª
        case 407://é˜µé›¨å¤¹é›ª
        case 408://å°åˆ°ä¸­é›ª
        case 409://ä¸­åˆ°å¤§é›ª
        case 410://é›ª
        case 456://é˜µé›¨å¤¹é›ª
        case 457://é˜µé›ª
        case 499://é›ª
            Serial.println(&quot;é›ªå¤©\r\n&quot;);
            break;

        //é›¾éœ¾
        case 500://è–„é›¾
        case 501://é›¾
        case 509://æµ“é›¾
        case 510://å¼ºæµ“é›¾
        case 514://å¤§é›¾
        case 515://ç‰¹å¼ºæµ“é›¾
            Serial.println(&quot;é›¾å¤©\r\n&quot;);
            break;
        case 502://éœ¾
        case 511://ä¸­åº¦éœ¾
        case 512://é‡åº¦éœ¾
        case 513://ä¸¥é‡éœ¾
            Serial.println(&quot;é›¾éœ¾\r\n&quot;);
            break;
    }
}

void setup() 
{
  int count = 0;
  char disp_buf[50]={0};

  //ä¸²å£åˆå§‹åŒ–
  Serial.begin(9600);

  //å°è¯•è¿æ¥WIFIç½‘ç»œ
  WiFi.begin(WIFI_SSID, WIFI_PASSWORD); 
  //å°è¯•è¿æ¥ç›´è‡³è¶…æ—¶
  while (WiFi.status() != WL_CONNECTED) 
  {
    count++;
    if (count &gt; WIFI_RETRY_COUNT)
    {
      Serial.println(&quot;\r\nconnection failed.\r\n&quot;);
      break;
    }
    delay(500);
    Serial.print(&quot;.&quot;);
  }

  //è·å–å¤©æ°”æ•°æ®
  weather.update();

  //WIFIæ–­å¼€è¿æ¥
  WiFi.disconnect();

  //æ˜¾ç¤ºæœ€ä½ä¸æœ€é«˜æ¸©åº¦
  sprintf(disp_buf, &quot;TempMin = %d&quot;, weather.getTempMin(is_today));
  Serial.println(disp_buf);
  sprintf(disp_buf, &quot;TempMax = %d&quot;, weather.getTempMax(is_today));
  Serial.println(disp_buf);

  //æ˜¾ç¤ºå¤©æ°”æ ‡è¯†ä»£ç 
  sprintf(disp_buf, &quot;WeatherCode = %d&quot;, weather.getWeather(is_today, is_day));
  Serial.println(disp_buf);

  //æ ¹æ®å¤©æ°”æ ‡è¯†ä»£ç ç¡®å®šå¤©æ°”
  WeatherIcon(weather.getWeather(is_today, is_day));
}

void loop() 
{
  delay(1000);
}

</code></pre>
<h2 id="%E4%BB%A3%E7%A0%81%E9%AA%8C%E8%AF%81">ä»£ç éªŒè¯</h2>
<hr />
<p>ä»£ç ç¼–å†™å®Œæˆä¹‹åï¼Œå°†ESP32S3å¼€å‘æ¿æ¥å…¥ç”µè„‘ä¸‹è½½ä»£ç ï¼Œç„¶åæ‰“å¼€ä¸²å£ç›‘è§†å™¨æŸ¥çœ‹ç°è±¡ã€‚</p>
<blockquote>
<p>ä¸‹è½½æ­¥éª¤è¯·å‚è€ƒğŸ‘‰<a href="ds1302.html"  >RTCæ—¶é’Ÿé©±åŠ¨</a>ç« èŠ‚çš„ä»£ç éªŒè¯å°èŠ‚ã€‚</p>
</blockquote>
<p>å®é™…è·å–å¤©æ°”æ•°æ®çš„æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p>æœ€ä½æ¸©åº¦26ï¼Œæœ€é«˜æ¸©åº¦31ï¼Œå¤©æ°”ä»£ç ä¸º307ï¼Œå¯¹åº”çš„å°±æ˜¯å¤§é›¨ã€‚</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-57-17.png" alt="å›¾ 17" /></p>
<p>æŸ¥çœ‹å’Œé£å¤©æ°”çš„APIä¸­<a href="https://dev.qweather.com/docs/resource/icons/"  target="_blank">å¤©æ°”ä»£ç è¯´æ˜</a>ï¼Œç¡®è®¤æ•°æ®æ˜¯æ­£ç¡®çš„ã€‚</p>
<p><img src="../../static/images/docs/diy/picxel-clock/weather/weather-2024-12-05-23-57-22.png" alt="å›¾ 18" /></p>
<blockquote class="spoiler warning">
<p> è¯´æ˜ï¼šå¦‚æœä½ æ ¹æ®ä»£ç æ“ä½œè¿è¡Œä¸èµ·æ¥ï¼Œå¯ä»¥ä¸‹è½½ğŸ‘‰<a href="https://gitee.com/laoguaige/esp32-s3-r8-n8-pixel-clock/tree/master/example/weather"  target="_blank">ä¾‹ç¨‹</a>çœ‹çœ‹</p>
</blockquote>

                        
                    </div>
                </div>
                <div id="previous_next">
                    <div id="previous">
                        
                        <a href="/diy/picxel-clock/ntptime.html">
                            <span class="icon"></span>
                            <span class="label">5. è·å–ç½‘ç»œæ—¶é—´</span>
                        </a>
                        
                    </div>
                    <div id="next">
                        
                        <a href="/diy/picxel-clock/led-oscillating.html">
                            <span class="label">7. å®ç°FFTéŸ³å¾‹ç¯</span>
                            <span class="icon"></span>
                        </a>
                        
                    </div>
                </div>
                <div id="comments-container"></div>
            </div>
            <div id="toc_wrapper">
                <div id="toc">
                    <div id="toc_content">
                            
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a id="to_top" href="#"></a>
    <div id="doc_footer">
        <div id="footer">
            <div id="footer_top">
                <ul>
<li><a>é“¾æ¥</a><ul><li><a target="_blank" href="https://teedoc.neucrack.com">æœ¬ç½‘ç«™ä½¿ç”¨ teedoc æ„å»º</a></li>
</ul>
</li>
<li><a>ç«™é•¿</a><ul><li><a target="_blank" href="https://laoguaige.github.io/">è€æ€ªé¸½</a></li>
<li><a>é‚®ç®±: liguoyi@hdochub.cn</a>
</li>
</ul>
</li>
<li><a>æºç </a><ul><li><a target="_blank" href="https://github.com/LaoGuaiGe/laoguaige.github.io">æœ¬ç«™æºæ–‡ä»¶</a></li>
</ul>
</li>
</ul>

            </div>
            <div id="footer_bottom">
                <ul>
<li><a target="_blank" href="https://laoguaige.github.io/">Copyright Â© 2024 Hdochub</a></li>
</ul>

            </div>
        </div>
    </div>
    
        <script src="/teedoc-plugin-markdown-parser/mermaid.min.js"></script>
    
        <script>mermaid.initialize({startOnLoad:true});</script>
    
        <script src="/static/js/theme_default/tocbot.min.js"></script>
    
        <script src="/static/js/theme_default/main.js"></script>
    
        <script src="/static/js/theme_default/viewer.min.js"></script>
    
        <script src="/static/css/theme_default/prism.min.js"></script>
    
        <link rel="stylesheet" href="/static/js/add_hint/style.css" type="text/css"/>
    
        <script src="/static/js/add_hint/main.js"></script>
    
        <script src="/static/js/gitalk/gitalk.min.js"></script>
    
        <script src="/static/js/gitalk/main.js"></script>
    
        <script src="/static/js/custom.js"></script>
    
        <script src="/static/js/search/search_main.js"></script>
    
</body>

</html>